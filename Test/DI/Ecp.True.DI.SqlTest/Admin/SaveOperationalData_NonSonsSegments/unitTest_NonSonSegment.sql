/*-- ============================================================================================================================
-- Author:          Microsoft
-- Created date: 	Aug-05-2020
-- Description:     These test cases are for Non Son segment sps - User story 31878
--                  usp_SaveNonSonSegmentMovementDetails
--                  usp_SaveNonSonSegmentMovementQualityDetails
--                  usp_SaveNonSonSegmentInventoryQualityDetails
--                  usp_SaveNonSonSegmentInventoryDetails
-- Database backup Used:	backup of [dbaeuecpdevtrue] on August 05 2020
-- ==============================================================================================================================*/


/*-- DATA PREPARATION --*/
-- FETCH DATA WHERE isOperational=0 for Non Sons segment or manually updating some segments in local backup of dev db 

select * From admin.CategoryElement where ElementId IN (189329,191188,191227,183411)

--SET ISOPERATIONAL AS 0 TO MAKE THEM NON SONS SEGMENTS

UPDATE admin.CategoryElement
SET IsOperationalSegment=0
where ElementId in (189329,191188,191227,183411)


-- FETCH ASSOCIATED NODES AND START AND END DATES WITH ABOVE ELEMENTS --
select top 100 * from Admin.NodeTag where ElementId in (189329,191188,191227,183411)
/*	
NodeId	ElementId	StartDate				EndDate
43843	183411		2020-07-27 00:00:00.000	9999-12-31 00:00:00.000
43844	183411		2020-01-31 00:00:00.000	9999-12-31 00:00:00.000
43845	183411		2020-01-31 00:00:00.000	9999-12-31 00:00:00.000
43846	183411		2020-01-31 00:00:00.000	9999-12-31 00:00:00.000
45067	189329		2020-07-30 00:00:00.000	9999-12-31 00:00:00.000
45068	189329		2020-07-30 00:00:00.000	9999-12-31 00:00:00.000
45069	189329		2020-07-30 00:00:00.000	9999-12-31 00:00:00.000
45070	189329		2020-07-30 00:00:00.000	9999-12-31 00:00:00.000
45071	189329		2020-02-03 00:00:00.000	9999-12-31 00:00:00.000
45452	191188		2020-07-31 00:00:00.000	9999-12-31 00:00:00.000
45453	191188		2020-02-04 00:00:00.000	9999-12-31 00:00:00.000
45454	191188		2020-02-04 00:00:00.000	9999-12-31 00:00:00.000
45455	191188		2020-02-04 00:00:00.000	9999-12-31 00:00:00.000
45460	191227		2020-07-31 00:00:00.000	9999-12-31 00:00:00.000
45461	191227		2020-02-04 00:00:00.000	9999-12-31 00:00:00.000
45462	191227		2020-02-04 00:00:00.000	9999-12-31 00:00:00.000
45463	191227		2020-02-04 00:00:00.000	9999-12-31 00:00:00.000
 */
/*TESTING MOVEMENT DETAILS INFORMATION ->  admin.usp_SaveNonSonSegmentMovementDetails */

-- EXECUTING THE SP--
EXEC admin.usp_SaveNonSonSegmentMovementDetails 183411,43843,'2020-07-27','2020-08-01','4C1B89FC-B66D-4E1E-B1AA-FD4A6D6108C5'
SELECT * FROM ADMIN.[OperationalMovementOwner_NonSon]

 /* SAMPLE RESULTS*/

 /*
 RNo	MovementId		BatchId		MovementTransactionId	CalculationDate	TypeMovement			SourceNode	DestinationNode	SourceProduct	DestinationProduct	NetQuantity	GrossQuantity	MeasurementUnit	EventType	Order	Position	SystemName	SourceMovementId	OwnerName	Ownershipvolume	ExecutionDate	Rule	Movement	UncertaintyPercentage	Uncertainty	BackupMovementId	GlobalMovementId	ProductID	Ownershippercentage	InputElementName	InputNodeName	InputStartDate	InputEndDate	ExecutionId	CreatedBy	CreatedDate
1		1517046						123586					2020-07-28		Automation_4tq1a		Automation_gperh	Automation_di618	CRUDO CAMPO MAMBO	CRUDO CAMPO MAMBO	442558.55	200.00	Bbl	Insert			EXCEL	NULL	ECOPETROL	442558.55	2020-07-31 08:11:40.047	1	Pérdidas Identificadas	0.22	97362.88	NULL	NULL	10000002318	100.00	Automation_l0jij	Automation_di618	2020-07-27	2020-08-01	4C1B89FC-B66D-4E1E-B1AA-FD4A6D6108C5	ReportUser	2020-08-05 07:07:46.357
2		3615535						123576					2020-07-29		Automation_4tq1a		Automation_di618	Automation_p94a5	CRUDO CAMPO CUSUCO	CRUDO CAMPO CUSUCO	216871.82	200.00	Bbl	Insert			EXCEL	NULL	ECOPETROL	216871.82	2020-07-31 08:11:58.893	1	NULL	0.22	47711.80	NULL	NULL	10000002372	100.00	Automation_l0jij	Automation_di618	2020-07-27	2020-08-01	4C1B89FC-B66D-4E1E-B1AA-FD4A6D6108C5	ReportUser	2020-08-05 07:07:46.357
3		4020042						123575					2020-07-30		Automation_4tq1a		Automation_di618	Automation_p94a5	CRUDO CAMPO CUSUCO	CRUDO CAMPO CUSUCO	416871.82	200.00	Bbl	Insert			EXCEL	NULL	ECOPETROL	416871.82	2020-07-31 08:12:16.123	1	NULL	0.22	91711.80	NULL	NULL	10000002372	100.00	Automation_l0jij	Automation_di618	2020-07-27	2020-08-01	4C1B89FC-B66D-4E1E-B1AA-FD4A6D6108C5	ReportUser	2020-08-05 07:07:46.357
4		4305236						123580					2020-07-28		Automation_4tq1a		Automation_di618	Automation_p94a5	CRUDO CAMPO CUSUCO	CRUDO CAMPO CUSUCO	416871.82	200.00	Bbl	Insert			EXCEL	NULL	ECOPETROL	416871.82	2020-07-31 08:11:40.047	1	Pérdidas Identificadas	0.22	91711.80	NULL	NULL	10000002372	100.00	Automation_l0jij	Automation_di618	2020-07-27	2020-08-01	4C1B89FC-B66D-4E1E-B1AA-FD4A6D6108C5	ReportUser	2020-08-05 07:07:46.357
5		493562						123577					2020-07-28		Automation_4tq1a		Automation_xnm8x	Automation_di618	CRUDO CAMPO CUSUCO	CRUDO CAMPO CUSUCO	150000.00	200.00	Bbl	Insert			EXCEL	NULL	ECOPETROL	150000.00	2020-07-31 08:11:40.047	1	Pérdidas Identificadas	0.22	33000.00	NULL	NULL	10000002372	100.00	Automation_l0jij	Automation_di618	2020-07-27	2020-08-01	4C1B89FC-B66D-4E1E-B1AA-FD4A6D6108C5	ReportUser	2020-08-05 07:07:46.357
6		5339601						123581					2020-07-28		Automation_4tq1a		Automation_di618	Automation_p94a5	CRUDO CAMPO MAMBO	CRUDO CAMPO MAMBO	425470.40	200.00	Bbl	Insert			EXCEL	NULL	ECOPETROL	425470.40	2020-07-31 08:11:40.047	1	Pérdidas Identificadas	0.22	93603.49	NULL	NULL	10000002318	100.00	Automation_l0jij	Automation_di618	2020-07-27	2020-08-01	4C1B89FC-B66D-4E1E-B1AA-FD4A6D6108C5	ReportUser	2020-08-05 07:07:46.357
7		5794716						123582					2020-07-28		Automation_4tq1a		Automation_xnm8x	Automation_di618	CRUDO CAMPO CUSUCO	CRUDO CAMPO CUSUCO	401475.74	200.00	Bbl	Insert			EXCEL	NULL	ECOPETROL	401475.74	2020-07-31 08:11:40.047	1	Pérdidas Identificadas	0.22	88324.66	NULL	NULL	10000002372	100.00	Automation_l0jij	Automation_di618	2020-07-27	2020-08-01	4C1B89FC-B66D-4E1E-B1AA-FD4A6D6108C5	ReportUser	2020-08-05 07:07:46.357
8		5842444						123574					2020-07-30		Automation_4tq1a		Automation_xnm8x	Automation_di618	CRUDO CAMPO CUSUCO	CRUDO CAMPO CUSUCO	116871.82	200.00	Bbl	Insert			EXCEL	NULL	ECOPETROL	116871.82	2020-07-31 08:12:16.123	1	NULL	0.22	25711.80	NULL	NULL	10000002372	100.00	Automation_l0jij	Automation_di618	2020-07-27	2020-08-01	4C1B89FC-B66D-4E1E-B1AA-FD4A6D6108C5	ReportUser	2020-08-05 07:07:46.357
9		637317791138549253	NULL	123610					2020-07-30		Traslado de productos	Automation_di618	Automation_di618	CRUDO CAMPO MAMBO	CRUDO CAMPO CUSUCO	300086.37	NULL	Bbl	Insert			TRUE	NULL	ECOPETROL	300086.37	2020-07-31 08:12:16.123	1	Interfases	NULL	300086.37	NULL	NULL	10000002318	100.00	Automation_l0jij	Automation_di618	2020-07-27	2020-08-01	4C1B89FC-B66D-4E1E-B1AA-FD4A6D6108C5	ReportUser	2020-08-05 07:07:46.357
10		637317791138549253	NULL	123610					2020-07-30		Traslado de productos	Automation_di618	Automation_di618	CRUDO CAMPO MAMBO	CRUDO CAMPO CUSUCO	300086.37	NULL	Bbl	Insert			TRUE	NULL	ECOPETROL	300086.37	2020-07-31 08:12:16.123	1	Interfases	NULL	300086.37	NULL	NULL	10000002372	100.00	Automation_l0jij	Automation_di618	2020-07-27	2020-08-01	4C1B89FC-B66D-4E1E-B1AA-FD4A6D6108C5	ReportUser	2020-08-05 07:07:46.357
11		637317791143630822	NULL	123594					2020-07-30		Tolerancia				NULL				Automation_di618	NULL				CRUDO CAMPO MAMBO	1694.85		NULL	Bbl	Insert			TRUE	NULL	ECOPETROL	1694.85	2020-07-31 08:12:16.123	1	Tolerancia	NULL	1694.85	NULL	NULL	10000002318	100.00	Automation_l0jij	Automation_di618	2020-07-27	2020-08-01	4C1B89FC-B66D-4E1E-B1AA-FD4A6D6108C5	ReportUser	2020-08-05 07:07:46.357
12		637317791143630852	NULL	123595					2020-07-30		Tolerancia				NULL				Automation_di618	NULL				CRUDO CAMPO CUSUCO	1367.23		NULL	Bbl	Insert			TRUE	NULL	ECOPETROL	1367.23	2020-07-31 08:12:16.123	1	Tolerancia	NULL	1367.23	NULL	NULL	10000002372	100.00	Automation_l0jij	Automation_di618	2020-07-27	2020-08-01	4C1B89FC-B66D-4E1E-B1AA-FD4A6D6108C5	ReportUser	2020-08-05 07:07:46.357
13		637317791147591569	NULL	123596					2020-07-27		Pérdida no identificada	NULL				Automation_di618	NULL				CRUDO CAMPO CUSUCO	20708.00	NULL	Bbl	Insert			TRUE	NULL	ECOPETROL	20708.00	2020-07-31 08:11:17.943	1	NULL	NULL	20708.00	NULL	NULL	10000002372	100.00	Automation_l0jij	Automation_di618	2020-07-27	2020-08-01	4C1B89FC-B66D-4E1E-B1AA-FD4A6D6108C5	ReportUser	2020-08-05 07:07:46.357
14		637317791147591662	NULL	123597					2020-07-27		Pérdida no identificada	NULL				Automation_di618	NULL				CRUDO CAMPO MAMBO	97817.00	NULL	Bbl	Insert			TRUE	NULL	ECOPETROL	97817.00	2020-07-31 08:11:17.943	1	NULL	NULL	97817.00	NULL	NULL	10000002318	100.00	Automation_l0jij	Automation_di618	2020-07-27	2020-08-01	4C1B89FC-B66D-4E1E-B1AA-FD4A6D6108C5	ReportUser	2020-08-05 07:07:46.357
15		637317791147595691	NULL	123601					2020-07-28		Pérdida no identificada	NULL				Automation_di618	NULL				CRUDO CAMPO CUSUCO	423163.82	NULL	Bbl	Insert			TRUE	NULL	ECOPETROL	423163.82	2020-07-31 08:11:40.047	1	NULL	NULL	423163.82	NULL	NULL	10000002372	100.00	Automation_l0jij	Automation_di618	2020-07-27	2020-08-01	4C1B89FC-B66D-4E1E-B1AA-FD4A6D6108C5	ReportUser	2020-08-05 07:07:46.357
16		637317791147595713	NULL	123602					2020-07-28		Pérdida no identificada	NULL				Automation_di618	NULL				CRUDO CAMPO MAMBO	382203.40	NULL	Bbl	Insert			TRUE	NULL	ECOPETROL	382203.40	2020-07-31 08:11:40.047	1	NULL	NULL	382203.40	NULL	NULL	10000002318	100.00	Automation_l0jij	Automation_di618	2020-07-27	2020-08-01	4C1B89FC-B66D-4E1E-B1AA-FD4A6D6108C5	ReportUser	2020-08-05 07:07:46.357
17		637317791147597632	NULL	123606					2020-07-29		Pérdida no identificada	NULL				Automation_di618	NULL				CRUDO CAMPO CUSUCO	189871.82	NULL	Bbl	Insert			TRUE	NULL	ECOPETROL	189871.82	2020-07-31 08:11:58.893	1	NULL	NULL	189871.82	NULL	NULL	10000002372	100.00	Automation_l0jij	Automation_di618	2020-07-27	2020-08-01	4C1B89FC-B66D-4E1E-B1AA-FD4A6D6108C5	ReportUser	2020-08-05 07:07:46.357
18		637317791147597675	NULL	123607					2020-07-29		Pérdida no identificada	Automation_di618	NULL				CRUDO CAMPO MAMBO	NULL				20100.00	NULL	Bbl	Insert			TRUE	NULL	ECOPETROL	20100.00	2020-07-31 08:11:58.893	1	NULL	NULL	20100.00	NULL	NULL	10000002318	100.00	Automation_l0jij	Automation_di618	2020-07-27	2020-08-01	4C1B89FC-B66D-4E1E-B1AA-FD4A6D6108C5	ReportUser	2020-08-05 07:07:46.357
19		637317791147600256	NULL	123587					2020-07-30		Pérdida no identificada	NULL				Automation_di618	NULL				CRUDO CAMPO MAMBO	5441.52		NULL	Bbl	Insert			TRUE	NULL	ECOPETROL	5441.52	2020-07-31 08:12:16.123	1	NULL	NULL	5441.52	NULL	NULL	10000002318	100.00	Automation_l0jij	Automation_di618	2020-07-27	2020-08-01	4C1B89FC-B66D-4E1E-B1AA-FD4A6D6108C5	ReportUser	2020-08-05 07:07:46.357
20		637317791147600294	NULL	123588					2020-07-30		Pérdida no identificada	NULL				Automation_di618	NULL				CRUDO CAMPO CUSUCO	246.40		NULL	Bbl	Insert			TRUE	NULL	ECOPETROL	246.40	2020-07-31 08:12:16.123	1	NULL	NULL	246.40	NULL	NULL	10000002372	100.00	Automation_l0jij	Automation_di618	2020-07-27	2020-08-01	4C1B89FC-B66D-4E1E-B1AA-FD4A6D6108C5	ReportUser	2020-08-05 07:07:46.357
21		661063						123584					2020-07-28		Automation_4tq1a		Automation_gperh	Automation_di618	CRUDO CAMPO CUSUCO	CRUDO CAMPO CUSUCO	116000.25	200.00	Bbl	Insert			EXCEL	NULL	ECOPETROL	116000.25	2020-07-31 08:11:40.047	1	Pérdidas Identificadas	0.22	25520.06	NULL	NULL	10000002372	100.00	Automation_l0jij	Automation_di618	2020-07-27	2020-08-01	4C1B89FC-B66D-4E1E-B1AA-FD4A6D6108C5	ReportUser	2020-08-05 07:07:46.357
22		7202723						123573					2020-07-30		Automation_4tq1a		Automation_di618	Automation_p94a5	CRUDO CAMPO MAMBO	CRUDO CAMPO MAMBO	216871.82	200.00	Bbl	Insert			EXCEL	NULL	ECOPETROL	216871.82	2020-07-31 08:12:16.123	1	NULL	0.22	47711.80	NULL	NULL	10000002318	100.00	Automation_l0jij	Automation_di618	2020-07-27	2020-08-01	4C1B89FC-B66D-4E1E-B1AA-FD4A6D6108C5	ReportUser	2020-08-05 07:07:46.357
23		7647901						123578					2020-07-30		Automation_4tq1a		Automation_gperh	Automation_di618	CRUDO CAMPO MAMBO	CRUDO CAMPO MAMBO	516871.82	200.00	Bbl	Insert			EXCEL	NULL	ECOPETROL	516871.82	2020-07-31 08:12:16.123	1	NULL	0.22	113711.80	NULL	NULL	10000002318	100.00	Automation_l0jij	Automation_di618	2020-07-27	2020-08-01	4C1B89FC-B66D-4E1E-B1AA-FD4A6D6108C5	ReportUser	2020-08-05 07:07:46.357
24		8961699						123579					2020-07-29		Automation_4tq1a		Automation_gperh	Automation_di618	CRUDO CAMPO MAMBO	CRUDO CAMPO MAMBO	156871.82	200.00	Bbl	Insert			EXCEL	NULL	ECOPETROL	156871.82	2020-07-31 08:11:58.893	1	Pérdidas Identificadas	0.22	34511.80	NULL	NULL	10000002318	100.00	Automation_l0jij	Automation_di618	2020-07-27	2020-08-01	4C1B89FC-B66D-4E1E-B1AA-FD4A6D6108C5	ReportUser	2020-08-05 07:07:46.357
25		9412802						123585					2020-07-28		Automation_4tq1a		Automation_gperh	Automation_di618	CRUDO CAMPO MAMBO	CRUDO CAMPO MAMBO	432000.00	200.00	Bbl	Insert			EXCEL	NULL	ECOPETROL	432000.00	2020-07-31 08:11:40.047	1	Pérdidas Identificadas	0.22	95040.00	NULL	NULL	10000002318	100.00	Automation_l0jij	Automation_di618	2020-07-27	2020-08-01	4C1B89FC-B66D-4E1E-B1AA-FD4A6D6108C5	ReportUser	2020-08-05 07:07:46.357
26		9643611						123583					2020-07-29		Automation_4tq1a		Automation_xnm8x	Automation_di618	CRUDO CAMPO CUSUCO	CRUDO CAMPO CUSUCO	426871.82	200.00	Bbl	Insert			EXCEL	NULL	ECOPETROL	426871.82	2020-07-31 08:11:58.893	1	Pérdidas Identificadas	0.22	93911.80	NULL	NULL	10000002372	100.00	Automation_l0jij	Automation_di618	2020-07-27	2020-08-01	4C1B89FC-B66D-4E1E-B1AA-FD4A6D6108C5	ReportUser	2020-08-05 07:07:46.357
*/

/*MOVEMENT QUALITY DETAILS -> usp_SaveNonSonSegmentMovementQualityDetails */

EXEC  [Admin].[usp_SaveNonSonSegmentMovementQualityDetails] 183411,43843,'2020-07-27','2020-08-01','4C1B89FC-B66D-4E1E-B1AA-FD4A6D6108C5'

SELECT * fROM [Admin].OperationalMovementQuality_NonSon

/*
RNo	BatchId	MovementId	MovementTransactionId	CalculationDate			MovementTypeName	SourceNode			DestinationNode		SourceProduct		DestinationProduct	NetStandardVolume	GrossStandardVolume	MeasurementUnit	EventType	SystemName	Movement	SourceMovementId	Order	Position	AttributeId	AttributeValue	ValueAttributeUnit	AttributeDescription	ProductID	InputElementName	InputNodeName	InputStartDate	InputEndDate	ExecutionId	CreatedBy	CreatedDate
1			1517046		123586					2020-07-28 00:00:00.000	Automation_4tq1a	Automation_gperh	Automation_di618	CRUDO CAMPO MAMBO	CRUDO CAMPO MAMBO	442558.55	200.00	Bbl	Insert	EXCEL	Pérdidas Identificadas	NULL			Automation_clwh6	100	Automation_kzrzm	Description 1	10000002318	Automation_l0jij	Automation_di618	2020-07-27	2020-08-01	4C1B89FC-B66D-4E1E-B1AA-FD4A6D6108C5	ReportUser	2020-08-05 07:07:46.357
22			7202723		123573					2020-07-30 00:00:00.000	Automation_4tq1a	Automation_di618	Automation_p94a5	CRUDO CAMPO MAMBO	CRUDO CAMPO MAMBO	216871.82	200.00	Bbl	Insert	EXCEL	NULL	NULL			Automation_clwh6	100	Automation_kzrzm	Description 14	10000002318	Automation_l0jij	Automation_di618	2020-07-27	2020-08-01	4C1B89FC-B66D-4E1E-B1AA-FD4A6D6108C5	ReportUser	2020-08-05 07:07:46.357
8			5842444		123574					2020-07-30 00:00:00.000	Automation_4tq1a	Automation_xnm8x	Automation_di618	CRUDO CAMPO CUSUCO	CRUDO CAMPO CUSUCO	116871.82	200.00	Bbl	Insert	EXCEL	NULL	NULL			Automation_clwh6	100	Automation_kzrzm	Description 13	10000002372	Automation_l0jij	Automation_di618	2020-07-27	2020-08-01	4C1B89FC-B66D-4E1E-B1AA-FD4A6D6108C5	ReportUser	2020-08-05 07:07:46.357
3			4020042		123575					2020-07-30 00:00:00.000	Automation_4tq1a	Automation_di618	Automation_p94a5	CRUDO CAMPO CUSUCO	CRUDO CAMPO CUSUCO	416871.82	200.00	Bbl	Insert	EXCEL	NULL	NULL			Automation_clwh6	100	Automation_kzrzm	Description 15	10000002372	Automation_l0jij	Automation_di618	2020-07-27	2020-08-01	4C1B89FC-B66D-4E1E-B1AA-FD4A6D6108C5	ReportUser	2020-08-05 07:07:46.357
2			3615535		123576					2020-07-29 00:00:00.000	Automation_4tq1a	Automation_di618	Automation_p94a5	CRUDO CAMPO CUSUCO	CRUDO CAMPO CUSUCO	216871.82	200.00	Bbl	Insert	EXCEL	NULL	NULL			Automation_clwh6	100	Automation_kzrzm	Description 11	10000002372	Automation_l0jij	Automation_di618	2020-07-27	2020-08-01	4C1B89FC-B66D-4E1E-B1AA-FD4A6D6108C5	ReportUser	2020-08-05 07:07:46.357
5			493562		123577					2020-07-28 00:00:00.000	Automation_4tq1a	Automation_xnm8x	Automation_di618	CRUDO CAMPO CUSUCO	CRUDO CAMPO CUSUCO	150000.00	200.00	Bbl	Insert	EXCEL	Pérdidas Identificadas	NULL			Automation_clwh6	100	Automation_kzrzm	Description 5	10000002372	Automation_l0jij	Automation_di618	2020-07-27	2020-08-01	4C1B89FC-B66D-4E1E-B1AA-FD4A6D6108C5	ReportUser	2020-08-05 07:07:46.357
23			7647901		123578					2020-07-30 00:00:00.000	Automation_4tq1a	Automation_gperh	Automation_di618	CRUDO CAMPO MAMBO	CRUDO CAMPO MAMBO	516871.82	200.00	Bbl	Insert	EXCEL	NULL	NULL			Automation_clwh6	100	Automation_kzrzm	Description 12	10000002318	Automation_l0jij	Automation_di618	2020-07-27	2020-08-01	4C1B89FC-B66D-4E1E-B1AA-FD4A6D6108C5	ReportUser	2020-08-05 07:07:46.357
24			8961699		123579					2020-07-29 00:00:00.000	Automation_4tq1a	Automation_gperh	Automation_di618	CRUDO CAMPO MAMBO	CRUDO CAMPO MAMBO	156871.82	200.00	Bbl	Insert	EXCEL	Pérdidas Identificadas	NULL			Automation_clwh6	100	Automation_kzrzm	Description 8	10000002318	Automation_l0jij	Automation_di618	2020-07-27	2020-08-01	4C1B89FC-B66D-4E1E-B1AA-FD4A6D6108C5	ReportUser	2020-08-05 07:07:46.357
4			4305236		123580					2020-07-28 00:00:00.000	Automation_4tq1a	Automation_di618	Automation_p94a5	CRUDO CAMPO CUSUCO	CRUDO CAMPO CUSUCO	416871.82	200.00	Bbl	Insert	EXCEL	Pérdidas Identificadas	NULL			Automation_clwh6	100	Automation_kzrzm	Description 7	10000002372	Automation_l0jij	Automation_di618	2020-07-27	2020-08-01	4C1B89FC-B66D-4E1E-B1AA-FD4A6D6108C5	ReportUser	2020-08-05 07:07:46.357
6			5339601		123581					2020-07-28 00:00:00.000	Automation_4tq1a	Automation_di618	Automation_p94a5	CRUDO CAMPO MAMBO	CRUDO CAMPO MAMBO	425470.40	200.00	Bbl	Insert	EXCEL	Pérdidas Identificadas	NULL			Automation_clwh6	100	Automation_kzrzm	Description 6	10000002318	Automation_l0jij	Automation_di618	2020-07-27	2020-08-01	4C1B89FC-B66D-4E1E-B1AA-FD4A6D6108C5	ReportUser	2020-08-05 07:07:46.357
7			5794716		123582					2020-07-28 00:00:00.000	Automation_4tq1a	Automation_xnm8x	Automation_di618	CRUDO CAMPO CUSUCO	CRUDO CAMPO CUSUCO	401475.74	200.00	Bbl	Insert	EXCEL	Pérdidas Identificadas	NULL			Automation_clwh6	100	Automation_kzrzm	Description 4	10000002372	Automation_l0jij	Automation_di618	2020-07-27	2020-08-01	4C1B89FC-B66D-4E1E-B1AA-FD4A6D6108C5	ReportUser	2020-08-05 07:07:46.357
26			9643611		123583					2020-07-29 00:00:00.000	Automation_4tq1a	Automation_xnm8x	Automation_di618	CRUDO CAMPO CUSUCO	CRUDO CAMPO CUSUCO	426871.82	200.00	Bbl	Insert	EXCEL	Pérdidas Identificadas	NULL			Automation_clwh6	100	Automation_kzrzm	Description 9	10000002372	Automation_l0jij	Automation_di618	2020-07-27	2020-08-01	4C1B89FC-B66D-4E1E-B1AA-FD4A6D6108C5	ReportUser	2020-08-05 07:07:46.357
21			661063		123584					2020-07-28 00:00:00.000	Automation_4tq1a	Automation_gperh	Automation_di618	CRUDO CAMPO CUSUCO	CRUDO CAMPO CUSUCO	116000.25	200.00	Bbl	Insert	EXCEL	Pérdidas Identificadas	NULL			Automation_clwh6	100	Automation_kzrzm	Description 3	10000002372	Automation_l0jij	Automation_di618	2020-07-27	2020-08-01	4C1B89FC-B66D-4E1E-B1AA-FD4A6D6108C5	ReportUser	2020-08-05 07:07:46.357
25			9412802		123585					2020-07-28 00:00:00.000	Automation_4tq1a	Automation_gperh	Automation_di618	CRUDO CAMPO MAMBO	CRUDO CAMPO MAMBO	432000.00	200.00	Bbl	Insert	EXCEL	Pérdidas Identificadas	NULL			Automation_clwh6	100	Automation_kzrzm	Description 2	10000002318	Automation_l0jij	Automation_di618	2020-07-27	2020-08-01	4C1B89FC-B66D-4E1E-B1AA-FD4A6D6108C5	ReportUser	2020-08-05 07:07:46.357

*/
/* INVENTORY DETAILS -> usp_SaveNonSonSegmentInventoryDetails */
EXEC admin.usp_SaveNonSonSegmentInventoryDetails 183411,43843,'2020-07-27','2020-08-01','4C1B89FC-B66D-4E1E-B1AA-FD4A6D6108C5'
SELECT * FROM Admin.[OperationalInventoryOwner_NonSons]

/*
RNo	InventoryId		InventoryProductId	CalculationDate				NodeName						OwnerName		TankName	BatchId	Product				ProductId	NetStandardVolume	MeasurementUnit	EventType	SystemName	PercentStandardUnCertainty	Uncertainty	Ownershipvolume	OwnershipPercentage	AppliedRule	GrossStandardQuantity	InputElementName	InputNodeName	InputStartDate	InputEndDate	ExecutionId	CreatedBy	CreatedDate
1	DEFECT 199292	18889				2020-07-27 00:00:00.000		Automation_di618				ECOPETROL							CRUDO CAMPO MAMBO	10000002318	9500.00				Bbl	Insert	EXCEL	0.21	1995.00	9500.00	100.00	1	120.00	183411	43843	2020-07-27	2020-08-01	4C1B89FC-B66D-4E1E-B1AA-FD4A6D6108C5	ReportUser	2020-08-05 08:21:24.140
2	DEFECT 230890	18885				2020-07-27 00:00:00.000		Automation_di618				ECOPETROL							CRUDO CAMPO CUSUCO	10000002372	1200.00				Bbl	Insert	EXCEL	0.21	252.00	1200.00	100.00	1	120.00	183411	43843	2020-07-27	2020-08-01	4C1B89FC-B66D-4E1E-B1AA-FD4A6D6108C5	ReportUser	2020-08-05 08:21:24.140
3	DEFECT 239992	18883				2020-07-30 00:00:00.000		Automation_di618				ECOPETROL							CRUDO CAMPO MAMBO	10000002318	41500.00			Bbl	Insert	EXCEL	0.21	8715.00	41500.00	100.00	1	120.00	183411	43843	2020-07-27	2020-08-01	4C1B89FC-B66D-4E1E-B1AA-FD4A6D6108C5	ReportUser	2020-08-05 08:21:24.140
4	DEFECT 248940	18888				2020-07-27 00:00:00.000		Automation_di618				ECOPETROL							CRUDO CAMPO MAMBO	10000002318	88317.00			Bbl	Insert	EXCEL	0.21	18546.57	88317.00	100.00	1	120.00	183411	43843	2020-07-27	2020-08-01	4C1B89FC-B66D-4E1E-B1AA-FD4A6D6108C5	ReportUser	2020-08-05 08:21:24.140
5	DEFECT 371654	18881				2020-07-29 00:00:00.000		Automation_di618				ECOPETROL							CRUDO CAMPO MAMBO	10000002318	34450.00			Bbl	Insert	EXCEL	0.21	7234.50	34450.00	100.00	1	120.00	183411	43843	2020-07-27	2020-08-01	4C1B89FC-B66D-4E1E-B1AA-FD4A6D6108C5	ReportUser	2020-08-05 08:21:24.140
6	DEFECT 408820	18887				2020-07-28 00:00:00.000		Automation_di618				ECOPETROL							CRUDO CAMPO MAMBO	10000002318	54550.00			Bbl	Insert	EXCEL	0.21	11455.50	54550.00	100.00	1	120.00	183411	43843	2020-07-27	2020-08-01	4C1B89FC-B66D-4E1E-B1AA-FD4A6D6108C5	ReportUser	2020-08-05 08:21:24.140
7	DEFECT 666547	18884				2020-07-27 00:00:00.000		Automation_di618				ECOPETROL							CRUDO CAMPO CUSUCO	10000002372	19508.00			Bbl	Insert	EXCEL	0.21	4096.68	19508.00	100.00	1	120.00	183411	43843	2020-07-27	2020-08-01	4C1B89FC-B66D-4E1E-B1AA-FD4A6D6108C5	ReportUser	2020-08-05 08:21:24.140
8	DEFECT 738915	18886				2020-07-28 00:00:00.000		Automation_di618				ECOPETROL							CRUDO CAMPO CUSUCO	10000002372	27000.00			Bbl	Insert	EXCEL	0.21	5670.00	27000.00	100.00	1	120.00	183411	43843	2020-07-27	2020-08-01	4C1B89FC-B66D-4E1E-B1AA-FD4A6D6108C5	ReportUser	2020-08-05 08:21:24.140
9	DEFECT 964955	18882				2020-07-30 00:00:00.000		Automation_di618				ECOPETROL							CRUDO CAMPO CUSUCO	10000002372	1700.00				Bbl	Insert	EXCEL	0.21	357.00	1700.00	100.00	1	120.00	183411	43843	2020-07-27	2020-08-01	4C1B89FC-B66D-4E1E-B1AA-FD4A6D6108C5	ReportUser	2020-08-05 08:21:24.140
*/

/*Inventory Quality -> usp_SaveNonSonSegmentInventoryQualityDetails */

exec [Admin].[usp_SaveNonSonSegmentInventoryQualityDetails] 183411,43843,'2020-07-27','2020-08-01','4C1B89FC-B66D-4E1E-B1AA-FD4A6D6108C5'
SELECT * FROM [Admin].[OperationalInventoryQuality_NonSon] 

/*
RNo	InventoryId	    InventoryProductId	CalculationDate	        NodeName	        TankName	BatchId	Product	            ProductId	NetStandardVolume	GrossStandardQuantity	MeasurementUnit	Order	SystemName	AttributeId	AttributeValue	ValueAttributeUnit	AttributeDescription	InputElementName	InputNodeName	InputStartDate	InputEndDate	ExecutionId	CreatedBy	CreatedDate
5	DEFECT 371654	18881	            2020-07-29 00:00:00.000	Automation_di618			            CRUDO CAMPO MAMBO	10000002318	34450.00	120.00	Bbl	NULL	EXCEL	Automation_clwh6	100	Automation_kzrzm	Description 7	Automation_l0jij	Automation_di618	2020-07-27	2020-08-01	4C1B89FC-B66D-4E1E-B1AA-FD4A6D6108C5	ReportUser	2020-08-05 08:43:47.097
9	DEFECT 964955	18882	            2020-07-30 00:00:00.000	Automation_di618			            CRUDO CAMPO CUSUCO	10000002372	1700.00	120.00	Bbl	NULL	EXCEL	Automation_clwh6	100	Automation_kzrzm	Description 10	Automation_l0jij	Automation_di618	2020-07-27	2020-08-01	4C1B89FC-B66D-4E1E-B1AA-FD4A6D6108C5	ReportUser	2020-08-05 08:43:47.097
3	DEFECT 239992	18883	            2020-07-30 00:00:00.000	Automation_di618			            CRUDO CAMPO MAMBO	10000002318	41500.00	120.00	Bbl	NULL	EXCEL	Automation_clwh6	100	Automation_kzrzm	Description 9	Automation_l0jij	Automation_di618	2020-07-27	2020-08-01	4C1B89FC-B66D-4E1E-B1AA-FD4A6D6108C5	ReportUser	2020-08-05 08:43:47.097
7	DEFECT 666547	18884	            2020-07-27 00:00:00.000	Automation_di618			            CRUDO CAMPO CUSUCO	10000002372	19508.00	120.00	Bbl	NULL	EXCEL	Automation_clwh6	100	Automation_kzrzm	Description 3	Automation_l0jij	Automation_di618	2020-07-27	2020-08-01	4C1B89FC-B66D-4E1E-B1AA-FD4A6D6108C5	ReportUser	2020-08-05 08:43:47.097
2	DEFECT 230890	18885	            2020-07-27 00:00:00.000	Automation_di618			            CRUDO CAMPO CUSUCO	10000002372	1200.00	120.00	Bbl	NULL	EXCEL	Automation_clwh6	100	Automation_kzrzm	Description 4	Automation_l0jij	Automation_di618	2020-07-27	2020-08-01	4C1B89FC-B66D-4E1E-B1AA-FD4A6D6108C5	ReportUser	2020-08-05 08:43:47.097
8	DEFECT 738915	18886	            2020-07-28 00:00:00.000	Automation_di618			            CRUDO CAMPO CUSUCO	10000002372	27000.00	120.00	Bbl	NULL	EXCEL	Automation_clwh6	100	Automation_kzrzm	Description 6	Automation_l0jij	Automation_di618	2020-07-27	2020-08-01	4C1B89FC-B66D-4E1E-B1AA-FD4A6D6108C5	ReportUser	2020-08-05 08:43:47.097
6	DEFECT 408820	18887	            2020-07-28 00:00:00.000	Automation_di618			            CRUDO CAMPO MAMBO	10000002318	54550.00	120.00	Bbl	NULL	EXCEL	Automation_clwh6	100	Automation_kzrzm	Description 5	Automation_l0jij	Automation_di618	2020-07-27	2020-08-01	4C1B89FC-B66D-4E1E-B1AA-FD4A6D6108C5	ReportUser	2020-08-05 08:43:47.097
4	DEFECT 248940	18888	            2020-07-27 00:00:00.000	Automation_di618			            CRUDO CAMPO MAMBO	10000002318	88317.00	120.00	Bbl	NULL	EXCEL	Automation_clwh6	100	Automation_kzrzm	Description 1	Automation_l0jij	Automation_di618	2020-07-27	2020-08-01	4C1B89FC-B66D-4E1E-B1AA-FD4A6D6108C5	ReportUser	2020-08-05 08:43:47.097
1	DEFECT 199292	18889	            2020-07-27 00:00:00.000	Automation_di618			            CRUDO CAMPO MAMBO	10000002318	9500.00	120.00	Bbl	NULL	EXCEL	Automation_clwh6	100	Automation_kzrzm	Description 2	Automation_l0jij	Automation_di618	2020-07-27	2020-08-01	4C1B89FC-B66D-4E1E-B1AA-FD4A6D6108C5	ReportUser	2020-08-05 08:43:47.097


*/

exec [Admin].[usp_SaveNonSonSegment] 183411,43843,'2020-07-27','2020-08-01','4C1B89FC-B66D-4E1E-B1AA-FD4A6D6108C5'
SELECT * FROM [Admin].[OperationalNonSon] 
/*
ProductID		ProductName			OwnerName	MeasurementUnit	SegmentID	SegmentName	NodeId	CalculationDate	Inputs	Outputs	IdentifiedLosses	IntialInventory	FinalInventory	Interface	Tolerance	Control	InputElementName	InputNodeName	InputStartDate	InputEndDate	ExecutionId	CreatedBy	CreatedDate
10000002372		CRUDO CAMPO CUSUCO	ECOPETROL	Bbl				NULL		NULL		NULL	2020-07-30	0.00	1367.23	0.00	0.00	0.00	0.00	0.00	-1367.23	Automation_l0jij	Automation_di618	2020-07-27	2020-08-01	4C1B89FC-B66D-4E1E-B1AA-FD4A6D6108C5	ReportUser	2020-08-06 08:02:44.490
10000002372		CRUDO CAMPO CUSUCO	ECOPETROL	Bbl				NULL		NULL		NULL	2020-07-30	0.00	300086.37	0.00	0.00	0.00	0.00	0.00	-300086.37	Automation_l0jij	Automation_di618	2020-07-27	2020-08-01	4C1B89FC-B66D-4E1E-B1AA-FD4A6D6108C5	ReportUser	2020-08-06 08:02:44.490
10000002372		CRUDO CAMPO MAMBO	ECOPETROL	Bbl				NULL		NULL		NULL	2020-07-30	0.00	300086.37	0.00	0.00	0.00	0.00	0.00	-300086.37	Automation_l0jij	Automation_di618	2020-07-27	2020-08-01	4C1B89FC-B66D-4E1E-B1AA-FD4A6D6108C5	ReportUser	2020-08-06 08:02:44.490
10000002318		CRUDO CAMPO CUSUCO	ECOPETROL	Bbl				NULL		NULL		NULL	2020-07-30	0.00	300086.37	0.00	0.00	0.00	0.00	0.00	-300086.37	Automation_l0jij	Automation_di618	2020-07-27	2020-08-01	4C1B89FC-B66D-4E1E-B1AA-FD4A6D6108C5	ReportUser	2020-08-06 08:02:44.490
10000002318		CRUDO CAMPO MAMBO	ECOPETROL	Bbl				NULL		NULL		NULL	2020-07-30	0.00	1694.85	0.00	0.00	0.00	0.00	0.00	-1694.85	Automation_l0jij	Automation_di618	2020-07-27	2020-08-01	4C1B89FC-B66D-4E1E-B1AA-FD4A6D6108C5	ReportUser	2020-08-06 08:02:44.490
10000002318		CRUDO CAMPO MAMBO	ECOPETROL	Bbl				NULL		NULL		NULL	2020-07-30	0.00	300086.37	0.00	0.00	0.00	0.00	0.00	-300086.37	Automation_l0jij	Automation_di618	2020-07-27	2020-08-01	4C1B89FC-B66D-4E1E-B1AA-FD4A6D6108C5	ReportUser	2020-08-06 08:02:44.490
*/