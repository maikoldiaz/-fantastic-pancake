/*-- ============================================================================================================================
-- Author:          Microsoft
-- Create date: 	Jul-10-2020
-- Description:     This test script is to test usp_SaveMonthlyOfficialInventoryDetailsWithoutCutOff based on Element, Node, StartDate, EndDate.
--EXEC [Admin].[usp_SaveMonthlyOfficialInventoryDetailsWithoutCutOff] 137236,30812,'2020-06-26','2020-06-28','bd5b494e-ac14-466b-b507-0f93fd22ed7f'
--SELECT * FROM [Admin].[OfficialMonthlyBalance]
-- ==============================================================================================================================*/




---Ownership-------------------------------------------------
INSERT INTO [Offchain].[Ownership]
		(MessageTypeId,	TicketId,	MovementTransactionId,	InventoryProductId,	OwnerId,	OwnershipPercentage,	OwnershipVolume,		AppliedRule,		RuleVersion,		ExecutionDate,					BlockchainStatus,	BlockchainMovementTransactionId,	BlockchainInventoryProductTransactionId,	IsDeleted,	EventType,		BlockchainOwnershipId,					PreviousBlockchainOwnershipId,	TransactionHash,														BlockNumber,	RetryCount,	DeltaTicketId,	CreatedBy,	CreatedDate,					LastModifiedBy,	LastModifiedDate)
VALUES	(7,				23743,		11100,					8725,				30,			70.00,					2600.00,				'1',				'1',				'2020-06-04 13:18:47.250',		1,					NULL,								'343A23D9-596B-4E29-B336-9340708F0EA7',		0,			'Insert',		'30AC82E0-CA5C-47E5-B5A2-305F8DEBA820',	NULL,							'0x46ba288d20ac33a17e6b4f61fdbcc01f5449a7ecfcc09a1c5571c3f3a6018ec7',	'0x15e746',		0,			NULL,			'Test',		'2020-06-04 13:18:47.250',		NULL,			NULL		),
		(7,				23743,		11101,					8726,				30,			50.00,					2800.00,				'1',				'1',				'2020-06-04 13:18:47.263',		1,					NULL,								'343A23D9-596B-4E29-B336-9340708F0EA7',		0,			'Insert',		'30AC82E0-CA5C-47E5-B5A2-305F8DEBA820',	NULL,							'0x46ba288d20ac33a17e6b4f61fdbcc01f5449a7ecfcc09a1c5571c3f3a6018ec7',	'0x15e746',		0,			NULL,			'Test',		'2020-06-04 13:18:47.263',		NULL,			NULL		),
		(7,				23743,		11102,					8727,				30,			50.00,					2800.00,				'1',				'1',				'2020-06-04 13:18:47.280',		1,					NULL,								'343A23D9-596B-4E29-B336-9340708F0EA7',		0,			'Insert',		'30AC82E0-CA5C-47E5-B5A2-305F8DEBA820',	NULL,							'0x46ba288d20ac33a17e6b4f61fdbcc01f5449a7ecfcc09a1c5571c3f3a6018ec7',	'0x15e746',		0,			NULL,			'Test',		'2020-06-04 13:18:47.280',		NULL,			NULL		),
		(7,				23743,		11103,					8728,				30,			50.00,					8934.00,				'1',				'1',				'2020-06-04 13:18:47.290',		1,					NULL,								'343A23D9-596B-4E29-B336-9340708F0EA7',		0,			'Insert',		'30AC82E0-CA5C-47E5-B5A2-305F8DEBA820',	NULL,							'0x46ba288d20ac33a17e6b4f61fdbcc01f5449a7ecfcc09a1c5571c3f3a6018ec7',	'0x15e746',		0,			NULL,			'Test',		'2020-06-04 13:18:47.290',		NULL,			NULL		),
		(7,				23743,		11104,					8729,				30,			70.00,					9087.00,				'1',				'1',				'2020-06-04 13:18:47.300',		1,					NULL,								'343A23D9-596B-4E29-B336-9340708F0EA7',		0,			'Insert',		'30AC82E0-CA5C-47E5-B5A2-305F8DEBA820',	NULL,							'0x46ba288d20ac33a17e6b4f61fdbcc01f5449a7ecfcc09a1c5571c3f3a6018ec7',	'0x15e746',		0,			NULL,			'Test',		'2020-06-04 13:18:47.300',		NULL,			NULL		),
		(7,				23744,		11105,					8730,				30,			70.00,					2600.00,				'1',				'1',				'2020-06-04 13:20:11.530',		1,					NULL,								'343A23D9-596B-4E29-B336-9340708F0EA7',		0,			'Insert',		'30AC82E0-CA5C-47E5-B5A2-305F8DEBA820',	NULL,							'0x46ba288d20ac33a17e6b4f61fdbcc01f5449a7ecfcc09a1c5571c3f3a6018ec7',	'0x15e746',		0,			NULL,			'Test',		'2020-06-04 13:20:11.530',		NULL,			NULL		)

----------------------------------------------------------------

---InventoryProduct---------------------------------------------

INSERT INTO [Offchain].[InventoryProduct] 
		(ProductId,		ProductType,	ProductVolume,	GrossStandardQuantity,	MeasurementUnit,	UncertaintyPercentage,	BlockchainStatus,	BlockchainInventoryProductTransactionId,		TransactionHash,															SystemTypeId,	SystemName,		SourceSystem,	DestinationSystem,		EventType,	TankName,	InventoryId,		TicketId,		InventoryDate,				NodeId,	SegmentId,	ScenarioId,	IsDeleted,	FileRegistrationTransactionId,	OperatorId,	Version,	SourceSystemId,	DeltaTicketId,	CreatedBy,	CreatedDate,	LastModifiedBy,	LastModifiedDate)
VALUES
		('10000002372',	'137301',		1700.00	,		120.00,					'31',				0.21,					1,					'3666A5CD-9A5E-4CA3-9835-FDCD4E5E3162',			'0xfeeabc5bdab6f0d875d3ebc6c089e100d61d96b68b7c75ccccd7f4565543f56e',			3,				'EXCEL',		'EXCEL',			'TRUE',			'Insert',		'abc',	'DEFECT 305914',		24274,		'2020-07-06 09:02:24.593',	30824,	137290,			2,				0,			25514,						1000,		'1',			164,			1200,		'Test',		'2020-07-07 04:02:53.557',		'trueadmin',			'2020-07-07 04:06:12.020'),
		('10000002318',	'137301',		41500.00,		120.00,					'31',				0.21,					1,					'7F68103E-30FE-41DA-A05A-DFEB9327F663',			'0x7638b4c80c02bc615c92cb4242a9d42fa70342658e48b59facfc61616c98e04a',			3,				'EXCEL',		'EXCEL',			'TRUE',			'Insert',		'qwe',	'DEFECT 736762',		24274,		'2020-07-06 09:02:24.593',	30824,	137290,			2,				0,			25513,						1000,		'1',			164,			1200,		'Test',		'2020-07-07 04:02:53.903',		'trueadmin',			'2020-07-07 04:06:12.020'),
		('10000002372',	'137301',		3000.00	,		120.00,					'31',				0.21,					1,					'5536D357-DBB6-46A2-A413-049843E30C72',			'0xb6a624c3fb391ea54336c6b98a23935d90a2c73e536b0c31ed341d320dc60d0a',			3,				'EXCEL',		'EXCEL',			'TRUE',			'Insert',		'abv',	'DEFECT 692642',		24274,		'2020-07-05 09:02:24.593',	30824,	137290,			2,				0,			25512,						1000,		'1',			164,			1200,		'Test',		'2020-07-07 04:02:57.380',		'trueadmin',			'2020-07-07 04:06:12.020'),
		('10000002318',	'137301',		34450.00,		120.00,					'31',				0.21,					1,					'74DA4206-C2D2-427B-83A8-ED87A08A3473',			'0x1110ecd24cb6f7244efa53ed3b114c9ea44be538166d9377235f9dd446841173',			3,				'EXCEL',		'EXCEL',			'TRUE',			'Insert',		'wed',	'DEFECT 473417',		24274,		'2020-07-05 09:02:24.593',	30824,	137290,			2,				0,			25511,						1000,		'1',			164,			1200,		'Test',		'2020-07-07 04:02:58.513',		'trueadmin',			'2020-07-07 04:06:12.020'),
		('10000002372',	'137301',		27000.00,		120.00,					'31',				0.21,					1,					'0C079332-A172-4945-9EE1-D49FC7AAA093',			'0x51c6076d8710321481b2400ec3a14c20ccc59b4fe2f1f39320cc0057eae3bca9',			3,				'EXCEL',		'EXCEL',			'TRUE',			'Insert',		'azx',	'DEFECT 143431',		24274,		'2020-07-04 09:02:24.593',	30824,	137290,			2,				0,			25510,						1000,		'2',			164,			1200,		'Test',		'2020-07-07 04:03:02.753',		'trueadmin',			'2020-07-07 04:06:12.020'),
		('10000002318',	'137301',		54550.00,		120.00,					'31',				0.21,					1,					'9A66A46C-A3FB-4112-AEB5-E3FD907C2165',			'0x4479c8b8e7e35410159304e696bf7ad62b422e3b6da526f8e193e958872da621',			3,				'EXCEL',		'EXCEL',			'TRUE',			'Insert',		'bnh',	'DEFECT 301885',		24274,		'2020-07-04 09:02:24.593',	30824,	137290,			2,				0,			25509,						1000,		'2',			164,			1200,		'Test',		'2020-07-07 04:03:07.843',		'trueadmin',			'2020-07-07 04:06:12.020'),
		('10000002372',	'137301',		1200.00	,		120.00,					'31',				0.21,					1,					'8DF80A31-AC09-44F0-A812-0282EA972E52',			'0x4406821c5ea3d8c778d87f81aa99a8a16dab3ad1ff5d7af65698be7a84aeb612',			3,				'EXCEL',		'EXCEL',			'TRUE',			'Insert',		'uyt',	'DEFECT 161553',		24274,		'2020-07-03 09:02:24.593',	30824,	137290,			2,				0,			25508,						1000,		'2',			164,			1200,		'Test',		'2020-07-07 04:03:08.720',		'trueadmin',			'2020-07-07 04:06:12.020'),
		('10000002372',	'137301',		19508.00,		120.00,					'31',				0.21,					1,					'C3FBC722-857B-4D53-83EC-11E37FC49397',			'0x966acb34bce19da5be9147007f251c4c0afbaa4ca39c83826cdb579250e42700',			3,				'EXCEL',		'EXCEL',			'TRUE',			'Insert',		'vbg',	'DEFECT 460311',		24274,		'2020-07-03 09:02:24.593',	30824,	137290,			2,				0,			25507,						1000,		'2',			164,			1200,		'Test',		'2020-07-07 04:03:11.393',		'trueadmin',			'2020-07-07 04:06:12.020'),
		('10000002318',	'137301',		9500.00	,		120.00,					'31',				0.21,					1,					'6E5655D0-38A6-4649-8A01-1995E692899B',			'0x69994d5fab8b2f273921e3ae25bde4fb62c4c748af28f9555b88c2c2d01c3b73',			3,				'EXCEL',		'EXCEL',			'TRUE',			'Insert',		'iuk',	'DEFECT 370394',		24274,		'2020-07-03 09:02:24.593',	30824,	137290,			2,				0,			25532,						1000,		'2',			164,			1200,		'Test',		'2020-07-07 04:03:11.403',		'trueadmin',			'2020-07-07 04:06:12.020'),
		('10000002318',	'137301',		88317.00,		120.00,					'31',				0.21,					1,					'0878E4C5-73E4-4ACA-BB2E-8D1D16F12AB2',			'0x44cf5a0fb84a0aa634897bae975e50191d02ca0669eb86f3e7b4d92aa42c06d8',			3,				'EXCEL',		'EXCEL',			'TRUE',			'Insert',		'wsv',	'DEFECT 639475',		24274,		'2020-07-03 09:02:24.593',	30824,	137290,			2,				0,			25533,						1000,		'2',			164,			1200,		'Test',		'2020-07-07 04:03:12.710',		'trueadmin',			'2020-07-07 04:06:12.020')



--------------------------------------------------------------



EXEC [Admin].[usp_SaveMonthlyOfficialDataWithoutCutOffReport] 137290,30824,'2020-07-03' ,'2020-07-06' ,'B9E667B0-0EF0-4ACD-BAB6-C8FE92B6A7EFuser5'
EXEC [Admin].[usp_SaveMonthlyOfficialInventoryDetailsWithoutCutOff] 137290,30824,'2020-07-03' ,'2020-07-06' ,'B9E667B0-0EF0-4ACD-BAB6-C8FE92B6A7EFuser5'
--SELECT * FROM  [Admin].[OfficialNodeTagCalculationDate] WHERE ExecutionId = 'B9E667B0-0EF0-4ACD-BAB6-C8FE92B6A7EFuser5'
SELECT * FROM  [Admin].[OfficialMonthlyInventoryDetails]  WHERE ExecutionId = 'B9E667B0-0EF0-4ACD-BAB6-C8FE92B6A7EFuser5'




--RNo	System	Version		InventoryId		NodeName			Product				NetStandardVolume	GrossStandardQuantity	MeasurementUnit		Owner		OwnershipVolume		OwnershipPercentage		Origin	RegistrationDate			InventoryProductId	InputElementId	InputNodeId		InputStartDate	InputEndDate	ExecutionId									CreatedBy	CreatedDate
--1		EXCEL				DEFECT 305914	Automation_p6p3a	CRUDO CAMPO CUSUCO	1700.00				120.00					Bbl					ECOPETROL	2600.00				70.00					EXCEL	2020-07-06 00:00:00.000		8725				137290			30824			2020-07-03		2020-07-06		B9E667B0-0EF0-4ACD-BAB6-C8FE92B6A7EFuser5	system		2020-07-10 00:00:00.000
--2		EXCEL				DEFECT 305914	Automation_p6p3a	CRUDO CAMPO CUSUCO	1700.00				120.00					Bbl					ECOPETROL	2600.00				70.00					EXCEL	2020-07-06 00:00:00.000		8725				137290			30824			2020-07-03		2020-07-06		B9E667B0-0EF0-4ACD-BAB6-C8FE92B6A7EFuser5	system		2020-07-10 00:00:00.000
--3		EXCEL				DEFECT 305914	Automation_p6p3a	CRUDO CAMPO CUSUCO	1700.00				120.00					Bbl					ECOPETROL	2600.00				70.00					EXCEL	2020-07-06 00:00:00.000		8725				137290			30824			2020-07-03		2020-07-06		B9E667B0-0EF0-4ACD-BAB6-C8FE92B6A7EFuser5	system		2020-07-10 00:00:00.000
--4		EXCEL				DEFECT 305914	Automation_p6p3a	CRUDO CAMPO CUSUCO	1700.00				120.00					Bbl					ECOPETROL	2600.00				70.00					EXCEL	2020-07-06 00:00:00.000		8725				137290			30824			2020-07-03		2020-07-06		B9E667B0-0EF0-4ACD-BAB6-C8FE92B6A7EFuser5	system		2020-07-10 00:00:00.000
--5		EXCEL				DEFECT 692642	Automation_p6p3a	CRUDO CAMPO CUSUCO	3000.00				120.00					Bbl					ECOPETROL	2800.00				50.00					EXCEL	2020-07-05 00:00:00.000		8727				137290			30824			2020-07-03		2020-07-06		B9E667B0-0EF0-4ACD-BAB6-C8FE92B6A7EFuser5	system		2020-07-10 00:00:00.000
--6		EXCEL				DEFECT 692642	Automation_p6p3a	CRUDO CAMPO CUSUCO	3000.00				120.00					Bbl					ECOPETROL	2800.00				50.00					EXCEL	2020-07-05 00:00:00.000		8727				137290			30824			2020-07-03		2020-07-06		B9E667B0-0EF0-4ACD-BAB6-C8FE92B6A7EFuser5	system		2020-07-10 00:00:00.000
--7		EXCEL				DEFECT 692642	Automation_p6p3a	CRUDO CAMPO CUSUCO	3000.00				120.00					Bbl					ECOPETROL	2800.00				50.00					EXCEL	2020-07-05 00:00:00.000		8727				137290			30824			2020-07-03		2020-07-06		B9E667B0-0EF0-4ACD-BAB6-C8FE92B6A7EFuser5	system		2020-07-10 00:00:00.000
--8		EXCEL				DEFECT 692642	Automation_p6p3a	CRUDO CAMPO CUSUCO	3000.00				120.00					Bbl					ECOPETROL	2800.00				50.00					EXCEL	2020-07-05 00:00:00.000		8727				137290			30824			2020-07-03		2020-07-06		B9E667B0-0EF0-4ACD-BAB6-C8FE92B6A7EFuser5	system		2020-07-10 00:00:00.000
--9		EXCEL				DEFECT 143431	Automation_p6p3a	CRUDO CAMPO CUSUCO	27000.00			120.00					Bbl					ECOPETROL	9087.00				70.00					EXCEL	2020-07-04 00:00:00.000		8729				137290			30824			2020-07-03		2020-07-06		B9E667B0-0EF0-4ACD-BAB6-C8FE92B6A7EFuser5	system		2020-07-10 00:00:00.000
--10	EXCEL				DEFECT 143431	Automation_p6p3a	CRUDO CAMPO CUSUCO	27000.00			120.00					Bbl					ECOPETROL	9087.00				70.00					EXCEL	2020-07-04 00:00:00.000		8729				137290			30824			2020-07-03		2020-07-06		B9E667B0-0EF0-4ACD-BAB6-C8FE92B6A7EFuser5	system		2020-07-10 00:00:00.000
--11	EXCEL				DEFECT 143431	Automation_p6p3a	CRUDO CAMPO CUSUCO	27000.00			120.00					Bbl					ECOPETROL	9087.00				70.00					EXCEL	2020-07-04 00:00:00.000		8729				137290			30824			2020-07-03		2020-07-06		B9E667B0-0EF0-4ACD-BAB6-C8FE92B6A7EFuser5	system		2020-07-10 00:00:00.000
--12	EXCEL				DEFECT 143431	Automation_p6p3a	CRUDO CAMPO CUSUCO	27000.00			120.00					Bbl					ECOPETROL	9087.00				70.00					EXCEL	2020-07-04 00:00:00.000		8729				137290			30824			2020-07-03		2020-07-06		B9E667B0-0EF0-4ACD-BAB6-C8FE92B6A7EFuser5	system		2020-07-10 00:00:00.000
--13	EXCEL				DEFECT 301885	Automation_p6p3a	CRUDO CAMPO MAMBO	54550.00			120.00					Bbl					ECOPETROL	2600.00				70.00					EXCEL	2020-07-04 00:00:00.000		8730				137290			30824			2020-07-03		2020-07-06		B9E667B0-0EF0-4ACD-BAB6-C8FE92B6A7EFuser5	system		2020-07-10 00:00:00.000
--14	EXCEL				DEFECT 301885	Automation_p6p3a	CRUDO CAMPO MAMBO	54550.00			120.00					Bbl					ECOPETROL	2600.00				70.00					EXCEL	2020-07-04 00:00:00.000		8730				137290			30824			2020-07-03		2020-07-06		B9E667B0-0EF0-4ACD-BAB6-C8FE92B6A7EFuser5	system		2020-07-10 00:00:00.000
--15	EXCEL				DEFECT 301885	Automation_p6p3a	CRUDO CAMPO MAMBO	54550.00			120.00					Bbl					ECOPETROL	2600.00				70.00					EXCEL	2020-07-04 00:00:00.000		8730				137290			30824			2020-07-03		2020-07-06		B9E667B0-0EF0-4ACD-BAB6-C8FE92B6A7EFuser5	system		2020-07-10 00:00:00.000
--16	EXCEL				DEFECT 301885	Automation_p6p3a	CRUDO CAMPO MAMBO	54550.00			120.00					Bbl					ECOPETROL	2600.00				70.00					EXCEL	2020-07-04 00:00:00.000		8730				137290			30824			2020-07-03		2020-07-06		B9E667B0-0EF0-4ACD-BAB6-C8FE92B6A7EFuser5	system		2020-07-10 00:00:00.000
--17	EXCEL				DEFECT 473417	Automation_p6p3a	CRUDO CAMPO MAMBO	34450.00			120.00					Bbl					ECOPETROL	8934.00				50.00					EXCEL	2020-07-05 00:00:00.000		8728				137290			30824			2020-07-03		2020-07-06		B9E667B0-0EF0-4ACD-BAB6-C8FE92B6A7EFuser5	system		2020-07-10 00:00:00.000
--18	EXCEL				DEFECT 473417	Automation_p6p3a	CRUDO CAMPO MAMBO	34450.00			120.00					Bbl					ECOPETROL	8934.00				50.00					EXCEL	2020-07-05 00:00:00.000		8728				137290			30824			2020-07-03		2020-07-06		B9E667B0-0EF0-4ACD-BAB6-C8FE92B6A7EFuser5	system		2020-07-10 00:00:00.000
--19	EXCEL				DEFECT 473417	Automation_p6p3a	CRUDO CAMPO MAMBO	34450.00			120.00					Bbl					ECOPETROL	8934.00				50.00					EXCEL	2020-07-05 00:00:00.000		8728				137290			30824			2020-07-03		2020-07-06		B9E667B0-0EF0-4ACD-BAB6-C8FE92B6A7EFuser5	system		2020-07-10 00:00:00.000
--20	EXCEL				DEFECT 473417	Automation_p6p3a	CRUDO CAMPO MAMBO	34450.00			120.00					Bbl					ECOPETROL	8934.00				50.00					EXCEL	2020-07-05 00:00:00.000		8728				137290			30824			2020-07-03		2020-07-06		B9E667B0-0EF0-4ACD-BAB6-C8FE92B6A7EFuser5	system		2020-07-10 00:00:00.000
--21	EXCEL				DEFECT 736762	Automation_p6p3a	CRUDO CAMPO MAMBO	41500.00			120.00					Bbl					ECOPETROL	2800.00				50.00					EXCEL	2020-07-06 00:00:00.000		8726				137290			30824			2020-07-03		2020-07-06		B9E667B0-0EF0-4ACD-BAB6-C8FE92B6A7EFuser5	system		2020-07-10 00:00:00.000
--22	EXCEL				DEFECT 736762	Automation_p6p3a	CRUDO CAMPO MAMBO	41500.00			120.00					Bbl					ECOPETROL	2800.00				50.00					EXCEL	2020-07-06 00:00:00.000		8726				137290			30824			2020-07-03		2020-07-06		B9E667B0-0EF0-4ACD-BAB6-C8FE92B6A7EFuser5	system		2020-07-10 00:00:00.000
--23	EXCEL				DEFECT 736762	Automation_p6p3a	CRUDO CAMPO MAMBO	41500.00			120.00					Bbl					ECOPETROL	2800.00				50.00					EXCEL	2020-07-06 00:00:00.000		8726				137290			30824			2020-07-03		2020-07-06		B9E667B0-0EF0-4ACD-BAB6-C8FE92B6A7EFuser5	system		2020-07-10 00:00:00.000
--24	EXCEL				DEFECT 736762	Automation_p6p3a	CRUDO CAMPO MAMBO	41500.00			120.00					Bbl					ECOPETROL	2800.00				50.00					EXCEL	2020-07-06 00:00:00.000		8726				137290			30824			2020-07-03		2020-07-06		B9E667B0-0EF0-4ACD-BAB6-C8FE92B6A7EFuser5	system		2020-07-10 00:00:00.000